v {xschem version=3.4.8RC file_version=1.3}
G {}
K {}
V {}
S {}
F {}
E {}
B 2 -60 540 740 940 {flags=graph
y1=-0.014
y2=1.3
ypos1=0
ypos2=2
divy=5
subdivy=1
unity=1
x1=8.6679914e-09
x2=8.9571161e-09
subdivx=1
xlabmag=1.0
ylabmag=1.0
dataset=-1
unitx=1
logx=0
logy=0
linewidth_mult=0.5
divx=20
color="7 12 18 11"
node="cpout
out_a
in_c
vcont"}
B 2 1370 370 2170 770 {flags=graph
y1=-0.4198089
y2=1.6533911
ypos1=0
ypos2=2
divy=5
subdivy=1
unity=1
x1=8.6679914e-09
subdivx=1
xlabmag=1.0
ylabmag=1.0
dataset=-1
unitx=1
logx=0
logy=0
color="6 21 7 11"
node="in_a
vin
vout
out_a"
linewidth_mult=0.5
divx=20
hilight_wave=0
x2=8.9571161e-09}
N -360 -450 -360 -440 {
lab=IO_vdd}
N -300 -450 -300 -440 {
lab=IO_iovdd}
N -440 -450 -440 -440 {
lab=IO_vss}
N -500 -450 -500 -440 {
lab=IO_iovss}
N -220 210 270 210 {lab=IO_iovdd}
N 240 -60 300 -60 {lab=IO_vdd}
N 250 -70 300 -70 {lab=IO_vss}
N 260 -110 300 -110 {lab=IO_iovss}
N 270 -120 300 -120 {lab=IO_iovdd}
N 240 20 300 20 {lab=IO_vdd}
N 240 -60 240 20 {lab=IO_vdd}
N 250 10 300 10 {lab=IO_vss}
N 250 -70 250 10 {lab=IO_vss}
N 260 -30 300 -30 {lab=IO_iovss}
N 260 -110 260 -30 {lab=IO_iovss}
N 270 -40 300 -40 {lab=IO_iovdd}
N 270 -90 270 -40 {lab=IO_iovdd}
N -220 -120 -220 -40 {lab=IO_iovdd}
N 580 -90 600 -90 {lab=IO_iovdd}
N 270 -120 270 -90 {lab=IO_iovdd}
N 580 -10 600 -10 {lab=IO_iovss}
N 260 -30 260 -10 {lab=IO_iovss}
N 540 -120 540 -90 {lab=IO_iovdd}
N 270 -90 540 -90 {lab=IO_iovdd}
N 540 -50 540 -10 {lab=IO_iovss}
N 260 -10 540 -10 {lab=IO_iovss}
N -560 -40 -560 -10 {lab=IO_vss}
N -560 -130 -560 -90 {lab=IO_vdd}
N -260 -120 -220 -120 {lab=IO_iovdd}
N -220 -200 -220 -120 {lab=IO_iovdd}
N -260 -110 -210 -110 {lab=IO_iovss}
N -210 -190 -210 -110 {lab=IO_iovss}
N -260 -70 -200 -70 {lab=IO_vss}
N -260 -60 -190 -60 {lab=IO_vdd}
N -190 -90 -190 -60 {lab=IO_vdd}
N -260 -40 -220 -40 {lab=IO_iovdd}
N -260 -30 -210 -30 {lab=IO_iovss}
N -210 -110 -210 -30 {lab=IO_iovss}
N -260 10 -200 10 {lab=IO_vss}
N -200 -10 -200 10 {lab=IO_vss}
N -260 20 -190 20 {lab=IO_vdd}
N -190 -60 -190 20 {lab=IO_vdd}
N -510 -10 -200 -10 {lab=IO_vss}
N -600 -10 -560 -10 {lab=IO_vss}
N -200 -70 -200 -10 {lab=IO_vss}
N -600 -90 -560 -90 {lab=IO_vdd}
N -510 -90 -190 -90 {lab=IO_vdd}
N -220 120 -220 210 {lab=IO_iovdd}
N -210 130 -210 200 {lab=IO_iovss}
N -200 170 -200 190 {lab=IO_vss}
N -190 100 -190 180 {lab=IO_vdd}
N -190 180 240 180 {lab=IO_vdd}
N -190 -140 -190 -90 {lab=IO_vdd}
N -260 -150 -200 -150 {lab=IO_vss}
N -200 -150 -200 -70 {lab=IO_vss}
N -200 -270 -200 -150 {lab=IO_vss}
N -260 -190 -210 -190 {lab=IO_iovss}
N -210 -280 -210 -190 {lab=IO_iovss}
N -260 -200 -220 -200 {lab=IO_iovdd}
N -220 -290 -220 -200 {lab=IO_iovdd}
N -200 -270 250 -270 {lab=IO_vss}
N -560 -170 -500 -170 {lab=in_a}
N -560 -190 -560 -170 {lab=in_a}
N -600 -170 -560 -170 {lab=in_a}
N -260 -140 -190 -140 {lab=IO_vdd}
N -190 -260 -190 -140 {lab=IO_vdd}
N -40 -430 -20 -430 {lab=GND}
N -20 -430 -20 -420 {lab=GND}
N -120 -430 -100 -430 {lab=sub!}
N -120 -430 -120 -420 {lab=sub!}
N 20 190 250 190 {lab=IO_vss}
N 270 -40 270 210 {lab=IO_iovdd}
N 260 100 260 200 {lab=IO_iovss}
N 250 50 250 190 {lab=IO_vss}
N 240 40 240 180 {lab=IO_vdd}
N -150 -50 -130 -50 {lab=vout}
N -260 -170 -150 -170 {lab=vin}
N -210 200 260 200 {lab=IO_iovss}
N 170 -70 200 -70 {lab=vout}
N -900 170 -900 190 {lab=GND}
N -150 -190 -150 -170 {lab=vin}
N -150 -170 -150 -90 {lab=vin}
N -150 -90 -130 -90 {lab=vin}
N -900 -80 -900 -50 {lab=in_a}
N -510 -90 -510 -80 {lab=IO_vdd}
N -560 -90 -510 -90 {lab=IO_vdd}
N -510 -20 -510 -10 {lab=IO_vss}
N -560 -10 -510 -10 {lab=IO_vss}
N 580 -90 580 -80 {lab=IO_iovdd}
N 540 -90 580 -90 {lab=IO_iovdd}
N 580 -20 580 -10 {lab=IO_iovss}
N 540 -10 580 -10 {lab=IO_iovss}
N 20 -260 240 -260 {lab=IO_vdd}
N -200 190 20 190 {lab=IO_vss}
N 570 -200 570 -170 {lab=out_a}
N 270 -140 270 -120 {lab=IO_iovdd}
N 260 -150 260 -110 {lab=IO_iovss}
N 250 -190 250 -70 {lab=IO_vss}
N 240 -200 240 -60 {lab=IO_vdd}
N -210 -280 260 -280 {lab=IO_iovss}
N 200 -170 200 -70 {lab=vout}
N 200 -180 200 -170 {lab=vout}
N -220 -290 270 -290 {lab=IO_iovdd}
N 20 -260 20 -130 {lab=IO_vdd}
N -190 -260 20 -260 {lab=IO_vdd}
N 240 -200 300 -200 {lab=IO_vdd}
N 250 -190 300 -190 {lab=IO_vss}
N 270 -140 300 -140 {lab=IO_iovdd}
N 270 -290 270 -140 {lab=IO_iovdd}
N 260 -150 300 -150 {lab=IO_iovss}
N 260 -280 260 -150 {lab=IO_iovss}
N 240 -260 240 -200 {lab=IO_vdd}
N 250 -270 250 -190 {lab=IO_vss}
N 200 -170 300 -170 {lab=vout}
N -900 10 -900 110 {lab=#net1}
N 540 -170 570 -170 {lab=out_a}
N 570 -170 600 -170 {lab=out_a}
N -560 70 -500 70 {lab=#net2}
N -560 50 -560 70 {lab=#net2}
N -600 70 -560 70 {lab=#net2}
N -260 40 -220 40 {lab=IO_iovdd}
N -220 -40 -220 40 {lab=IO_iovdd}
N -260 50 -210 50 {lab=IO_iovss}
N -210 -30 -210 50 {lab=IO_iovss}
N -260 90 -200 90 {lab=IO_vss}
N -200 10 -200 90 {lab=IO_vss}
N -260 100 -190 100 {lab=IO_vdd}
N -190 20 -190 100 {lab=IO_vdd}
N -260 120 -220 120 {lab=IO_iovdd}
N -220 40 -220 120 {lab=IO_iovdd}
N -260 130 -210 130 {lab=IO_iovss}
N -210 50 -210 130 {lab=IO_iovss}
N -260 170 -200 170 {lab=IO_vss}
N -200 90 -200 170 {lab=IO_vss}
N -260 180 -190 180 {lab=IO_vdd}
N 240 40 300 40 {lab=IO_vdd}
N 240 20 240 40 {lab=IO_vdd}
N 250 50 300 50 {lab=IO_vss}
N 250 10 250 50 {lab=IO_vss}
N 260 90 300 90 {lab=IO_iovss}
N 260 -10 260 90 {lab=IO_iovss}
N 260 100 300 100 {lab=IO_iovss}
N 260 90 260 100 {lab=IO_iovss}
N 200 -70 200 120 {lab=vout}
N -60 60 -40 60 {lab=vcont}
N -40 -10 -40 60 {lab=vcont}
N -150 -50 -150 120 {lab=vout}
N -150 120 200 120 {lab=vout}
N 20 -10 20 190 {lab=IO_vss}
N 90 -10 90 70 {lab=vcont}
N -40 70 90 70 {lab=vcont}
N -40 60 -40 70 {lab=vcont}
C {vsource.sym} -360 -410 0 0 {name=V1 value=1.2}
C {gnd.sym} -360 -380 0 0 {name=l3 lab=GND}
C {lab_pin.sym} -360 -450 1 0 {name=p7 sig_type=std_logic lab=IO_vdd}
C {vsource.sym} -300 -410 0 0 {name=V2 value=3.3
}
C {gnd.sym} -300 -380 0 0 {name=l4 lab=GND}
C {lab_pin.sym} -300 -450 1 0 {name=p8 sig_type=std_logic lab=IO_iovdd}
C {vsource.sym} -440 -410 0 0 {name=V3 value=0 savecurrent=false}
C {gnd.sym} -440 -380 0 0 {name=l5 lab=GND}
C {lab_pin.sym} -440 -450 1 0 {name=p9 sig_type=std_logic lab=IO_vss}
C {vsource.sym} -500 -410 0 0 {name=V4 value=0 savecurrent=false}
C {gnd.sym} -500 -380 0 0 {name=l6 lab=GND}
C {lab_pin.sym} -500 -450 1 0 {name=p10 sig_type=std_logic lab=IO_iovss}
C {devices/code_shown.sym} -1540 -490 0 0 {name=MODEL only_toplevel=true
format="tcleval( @value )"
value="
.lib cornerMOSlv.lib mos_tt
.lib cornerMOShv.lib mos_tt
.lib cornerRES.lib res_typ
.lib cornerCAP.lib cap_typ
.include diodes.lib
.include sg13g2_bondpad.lib
.include /foss/pdks/ihp-sg13g2/libs.ref/sg13g2_stdcell/spice/sg13g2_stdcell.spice
"}
C {devices/code_shown.sym} -1540 -250 0 0 {name=NGSPICE only_toplevel=true 
value="
.param temp=27
*.OPTION RSHUNT=1e6
.OPTION CSHUNT=1e-13
.option rseries = 10.0e-0
.options method=gear reltol=1e-1 abstol=1e-1 vntol=1e-1
*.options reltol=1e-4 abstol=1e-12 vntol=1e-6
*.options gmin=1e-10
*.ic V(out)=0

.control
save all 



tran 30p 10n






write power_io.raw


.endc
"
spice_ignore=true}
C {lab_pin.sym} 540 -120 2 0 {name=p3 sig_type=std_logic lab=IO_iovdd}
C {lab_pin.sym} 540 -50 2 0 {name=p4 sig_type=std_logic lab=IO_iovss}
C {lab_pin.sym} -560 -130 0 1 {name=p5 sig_type=std_logic lab=IO_vdd}
C {lab_pin.sym} -560 -40 2 0 {name=p6 sig_type=std_logic lab=IO_vss}
C {sg13g2_IOPadIOVdd.sym} 420 -90 0 0 {name=x1}
C {sg13g2_IOPadIOVss.sym} 420 -10 0 0 {name=x3}
C {sg13g2_IOPadVSS.sym} -380 -10 0 1 {name=x2}
C {sg13g2_IOPadVdd.sym} -380 -90 0 1 {name=x4}
C {sg13g2_pr/bondpad.sym} 640 -10 1 0 {name=X6
model=bondpad
spiceprefix=X
size=80u
shape=0
padtype=0
}
C {sg13g2_pr/bondpad.sym} 640 -90 1 0 {name=X7
model=bondpad
spiceprefix=X
size=80u
shape=0
padtype=0
}
C {sg13g2_pr/bondpad.sym} -640 -90 3 1 {name=X8
model=bondpad
spiceprefix=X
size=80u
shape=0
padtype=0
}
C {sg13g2_pr/bondpad.sym} -640 -10 3 1 {name=X9
model=bondpad
spiceprefix=X
size=80u
shape=0
padtype=0
}
C {devices/launcher.sym} -840 970 0 0 {name=h5
descr="load waves Ctrl + left click" 
tclcommand="xschem raw_read $netlist_dir/power_io.raw tran"
}
C {sg13g2_IOPadAnalog.sym} -380 -170 0 1 {name=x13}
C {sg13g2_pr/bondpad.sym} -640 -170 3 1 {name=X14
model=bondpad
spiceprefix=X
size=80u
shape=0
padtype=0
}
C {gnd.sym} -900 190 0 0 {name=l7 lab=GND}
C {lab_pin.sym} -900 -80 1 0 {name=p11 sig_type=std_logic lab=in_a}
C {lab_pin.sym} -560 -190 1 0 {name=p1 sig_type=std_logic lab=in_a}
C {sg13g2_pr/sub.sym} -120 -420 0 0 {name=l8 lab=sub!}
C {gnd.sym} -20 -420 0 0 {name=l11 lab=GND}
C {vsource.sym} -70 -430 1 0 {name=V5 value=0 savecurrent=false}
C {sg13g2_pr/bondpad.sym} 640 -170 1 0 {name=X16
model=bondpad
spiceprefix=X
size=80u
shape=0
padtype=0
}
C {/foss/designs/DLL/2026/Cells/TOP.sym} 20 -70 0 0 {name=x17
}
C {lab_pin.sym} 570 -200 1 0 {name=p13 sig_type=std_logic lab=out_a}
C {vsource.sym} -900 140 0 0 {name=Vin value="PULSE(0 1.2 0 40p 40p 2n 4n)"
}
C {lab_pin.sym} -150 -190 1 0 {name=p16 sig_type=std_logic lab=vin}
C {lab_pin.sym} 200 -180 1 0 {name=p17 sig_type=std_logic lab=vout}
C {lab_pin.sym} -60 60 1 0 {name=p19 sig_type=std_logic lab=vcont}
C {res.sym} -900 -20 2 0 {name=R4
value=10
footprint=1206
device=resistor
m=1}
C {code.sym} -1050 -20 0 0 {name=TRANSIENT1 only_toplevel=true
value="
.options method=gear reltol=1e-1 abstol=1e-1 vntol=1e-1
.control
 tran 10p 20n 10p
 plot v(vin) v(vout)
 plot v(in_a) v(out_a)
 plot v(vout) v(out_a)
 plot v(vcont) 
 *plot i(V1) 
.endc
"
spice_ignore=true}
C {sg13g2_IOPadAnalog.sym} 420 -170 2 1 {name=x5
}
C {sg13g2_IOPadAnalog.sym} -380 70 0 1 {name=x10
}
C {sg13g2_pr/bondpad.sym} -640 70 3 1 {name=X11
model=bondpad
spiceprefix=X
size=80u
shape=0
padtype=0
}
C {code.sym} -840 -250 0 0 {name=PHASE_MEASR only_toplevel=true
value="
.options method=gear reltol=1e-1 abstol=1e-1 vntol=1e-1
.control
 tran 20p 50n 20p
* ---- settings you tweak ----


   * ---- user settings ----
  let vlow  = 0
  let vhigh = 1.2
  let v50   = vlow + 0.5*(vhigh - vlow)

  let start_edge = 0     ; skip early edges (settling)
  let N = 600             ; number of phase samples




  * ---- allocate vectors ----
  let tvec   = vector(N)
  let phivec = vector(N)

  let k = 0
  let i = start_edge

  while k < N
    * crossing times
    meas tran tin      WHEN v(in_a)=v50  RISE=i
    meas tran tout     WHEN v(out_a)=v50 RISE=i
    meas tran tin_next WHEN v(in_a)=v50  RISE=(i+1)

    * delay + period
    let dt = tout - tin
    let T  = tin_next - tin

    * phase in degrees (per-cycle)
    let phi = 360*dt/T
    let phi = phi - 360*floor(phi/360)

    * store sample at time = tin
    let tvec[k]   = tin
    let phivec[k] = phi

    let k = k + 1
    let i = i + 1
  end

  * plot phase vs time (one point per cycle)
  plot phivec vs tvec
  *plot v(vcont) 
  plot v(vin) v(vout) 
  plot v(in_a) v(out_a) 
  plot v(vcont)
.endc
"
}
